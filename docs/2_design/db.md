# 概要

Databaseの定義を書く。

## テーブル構成

| テーブル名 | 説明 |
|---|---|
| bad_codes | 悪いコードの情報を格納するテーブル |
| files | ファイルの情報を格納するテーブル |
| bad_codes_files | 悪いコードとファイルの関連情報を格納するテーブル |
| tags | 悪いコードのタグ情報を格納するテーブル |


## DB詳細

**bad_codesテーブル**

| カラム名 | データ型 | 説明 |
|---|---|---|
| id | INT | 悪いコードのID |
| title | VARCHAR(255) | 悪いコードのタイトル |
| language | VARCHAR(255) | 言語 |
| user_id | INT | 登録者ID |
| created_at | TIMESTAMP | 作成日時 |
| updated_at | TIMESTAMP | 更新日時 |

**filesテーブル**

| カラム名 | データ型 | 説明 |
|---|---|---|
| id | INT | ファイルID |
| name | VARCHAR(255) | ファイル名 |
| created_at | TIMESTAMP | 作成日時 |
| updated_at | TIMESTAMP | 更新日時 |

**bad_codes_filesテーブル**

| カラム名 | データ型 | 説明 |
|---|---|---|
| bad_code_id | INT | 悪いコードID |
| file_id | INT | ファイルID |
| created_at | TIMESTAMP | 作成日時 |
| updated_at | TIMESTAMP | 更新日時 |

**tags | 悪いコードのタグ情報を格納するテーブル |

**関係性**

| テーブル名 | 外部キー |
|---|---|
| bad_codes_files | bad_code_id (bad_codes.id) |
| bad_codes_files | file_id (files.id) |
| tags | bad_codes_id (bad_codes.id) |

**機能要件を満たすための設計**

* **悪いコードの閲覧**
    * bad_codesテーブルから、検索条件に一致するレコードを取得する。
    * 取得したレコードから、タイトル、ファイル名、言語、タグ、コメントなどの情報を表示する。
    * filesテーブルから、ファイル名を取得する。
* **悪いコードの登録**
    * 悪いコードのタイトル、ファイル名、言語、タグ、コメントを入力する。
    * bad_codesテーブルに、入力した情報を登録する。
    * filesテーブルに、ファイル名を登録する。
    * bad_codes_filesテーブルに、悪いコードとファイルの関連情報を登録する。
* **悪いコードの検索**
    * bad_codesテーブルから、検索条件に一致するレコードを取得する。
* **ファイル検索からの悪いコード一覧検索**
    * filesテーブルから、検索条件に一致するレコードを取得する。
    * 取得したレコードから、bad_codesテーブルに関連付けられたレコードを取得する。

**その他機能**

* **ログイン機能**
    * usersテーブルに、ユーザーID、メールアドレス、パスワードを登録する。
    * ユーザーIDとパスワードを入力して、ログインする。

このDB設計では、以下の点が変更されています。

* filesテーブルから、言語のカラムを削除しました。
* bad_codesテーブルに、言語のカラムを追加しました。
* tagsテーブルから、言語のカラムを削除しました。

この設計では、ファイルの言語はファイル名から推測します。また、悪いコードの言語は、登録時にユーザーが入力します。タグは、悪いコードのタグ検索のために存在するため、言語は不要です。